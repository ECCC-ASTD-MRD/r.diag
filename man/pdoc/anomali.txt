 
      CALL SEQUENCE...
       anomali  TSIN GGOUT MASK INPUT OUTPUT [-a VAL1 -t1 VAL2 -t2 VAL3]
 
 
      AUTHOR   - B.Dugas, DECEMBRE 22/85.
      LAST REVISION: $Header: /home/cvs/RMNLIB/utils/rdiag/lspgm/anomali.ptn,v 4.10 2014/09/25 20:20:45 dugas Exp $
 
 
      DESCRIPTION...
       anomali - TESTING A SET OF CONDITIONS ON SETS OF TIME SERIES
 
 
      PURPOSE  - DETERMINE LE NOMBRE DE FOIS QU'UN ENSEMBLE DE CRITERES EST
                 VERIFIE. DE PLUS LES POSITIONS DANS L'ESPACE ET DANS LE TEMPS
                 DE CES POINTS SONT IMPRIMES. UN POINT EST RETENU SSI LA VALEUR
                 DU CHAMPS Y EST PLUS GRANDE QUE M DEPUIS AU MOINS T1 INTERVALLES
                 ET POUR MOINS QUE T2 INTERVALLES. M, T1 ET T2 SONT LUS EN ENTREE
 
               ( EACH VALUE OF A TIME SERIES OF TSIN IS COMPARED WITH THE
                 VARIABLE M. IF THE NUMBER OF CONSECUTIVE DATA POINTS WHOSE
                 VALUES ARE GREATER THAN OR EQUAL TO M FALLS BETWEEN T1 AND
                 T2 (>=T1 AND <T2), IT IS RECORDED AS ONE EVENT. THE MASK FOR
                 THE DATA POINTS OF AN EVENT IS SET TO 1. ALL OTHER DATA POINTS
                 HAVE A MASK OF VALUE ZERO. EVENT NUMBER IS RECORDED FOR THE
                 'GEORGRAPHICAL' LOCATION THE TIME SERIES REPRESENTS. IT IS
                 ACCUMULATED OVER ALL TIME SERIES IN THE INPUT FILE )
 
 
      INPUT FILE...
       TSIN  = LE CHAMPS D'ENTREE TSIN EST SUPPOSE NE CORRESPONDRE QU'A
               UN NIVEAU DE PRESSION ET LES ENREGISTREMENTS INDIVIDUELS
               SONT DES SERIES TEMPORELLES (UNE SERIE PAR POINT DANS LA
               GRILLE SPACIALE).
             ( CONTAINS RECORDS OF GEOGRAPHIC POSITION TIME SERIES ON
               A SINGLE PRESSURE LEVEL )
 
      OUTPUT FILES...
       GGOUT = CONTIENT LE NOMBRE DE FOIS QUE LE CRITERE A ETE VERIFIE
               A CHAQUE POSITION GEOGRAPHIQUE.
             ( CONTAINS A RECORD FOR GEOGRAPHIC POSITIONS WITH VALUES
               CONSISTING OF THE NUMBER OF TIMES THE TEST CONDITIONS
               ARE SATISFIED )
       MASK  = EST UN FICHIER DE SERIES TEMPORELLES CONTENANT DES "1.0"S
               AUX MOMENTS VERIFIANT LE CRITERE ET ZERO AILLEUR.
             ( CONTAINS RECORDS OF TIME SERIES CONSISTING OF 1'S FOR
               POINTS PASSING THE TEST AND O'S OTHERWISE )
 
 
      INPUT PARAMETERS...
       M  = VALUE AGAINST WHICH THE VALUES READ ARE TO BE TESTED.
            (M.GT.0.0)
       T1 = LOWER LIMIT OF THE TIME RANGE (T1.GE.1)
       T2 = UPPER LIMIT OF THE TIME RANGE (T2.GT.T1).
            DEFAULTS TO THE LENGTH OF THE FIRST TIME SERIES.
 
       NOTE - A POINT PASSES THE VALUE TEST IF ITS POSITIONAL VALUE IS
              GREATER OR EQUAL TO M AND ITS TIME STAMP (TS) FALLS WITHIN
              THE TIME RANGE (T1,T2); (I.E., TS.GE.T1 .AND. TS.LT.T2).
 
       READ(5,5000) M,T1,T2
 5000  FORMAT(10X,E10.0,2I5)
 
 
      EXAMPLE OF INPUT CARD...
 
  ANOMALI.        1.    1    0
 
         0123456789012345678901234567890123456789012345678901234567890
         1         2         3         4         5         6         7
 
 
      EXIT CONDITIONS...
       0 NO PROBLEMS
       1 ILLEGAL INPUT PARAMETERS
       2 DATA TYPE NOT SUPPORTED
       3 UNABLE TO READ TSIN
       4 ILLEGAL GRID POSITION FOR TIME-SERIES
       5 PREMATURE END OF FILE ON INPUT
       6 PREMATURE END OF FILE ON TSIN
       7 MEMORY ALLOCATION PROBLEM
 
