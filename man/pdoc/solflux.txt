 
      CALL SEQUENCE...
       solflux  INFILE FSO INPUT OUTPUT \ 
                        [-a VAL1 -b VAL2 -delt VAL3 -c VAL4 \ 
                         -kind VAL5  [VAL6] -nhem VAL7 -i VA87 \ 
                         -j VAL9 -d60 VAL10 -dgrw VAL11 -K VAL12]
 
 
      DESCRIPTION...
       solflux - RE-COMPUTE THE INCIDENT SOLAR FLUX AT THE TOP OF THE MODEL
 
      AUTHOR  - R. Laprise, MAY 13/1983.
      LAST REVISION: $Header: /home/cvs/RMNLIB/utils/rdiag/lspgm/solflux.ptn,v 4.15 2014/09/25 20:20:53 dugas Exp $
 
 
      PURPOSE - RE-COMPUTE THE INCIDENT SOLAR FLUX AT THE TOP OF THE
                ATMOSPHERE FOR THE TIMESTEPS AND ON THE SAME GRID TYPE
                FOUND IN INFILE. THE ORIGINAL CODE WAS ADAPTED FROM SOLFLX
                AS WRITTEN BY J.P.BLANCHET AT CCRN.
 
 
      INPUT FILE...
       INFILE = A PROPERLY SORTED FILE PROVIDING THE
                GEOMETRY AND TIMESTEP INFORMATION.
 
      OUTPUT FILES...
       FSO = INCIDENT SOLAR FLUX AT TOA (W M-2)
 
  
     INPUT PARAMETERS...
 
      DAY    (a)      = INITIAL (JULIAN) DAY OF THE PERIOD
      GMT    (b)      = INITIAL G.M.TIME (HR)
      DELT            = LENGTH OF TIMESTEP OF MODEL RUN (S)
      INCDAY (kind-1) = 1,0 TO INCREMENT THE DECLINATION ANGLE OR NOT (DEF=1).
      DTM    (kind-2) = FLAG TO INDICATE METHOD OF TIME MEASUREMENT.
                      = 0 ==> IBUF(2),T1,T2 AND T3 IN KOUNT UNITS.
                      = 1 ==> IBUF(2),T1 AND T2 ARE IN THE FORMAT
                              YYYYMMDDHH AND T3 IS IN HOURS.
                      = 2 ==> IBUF(2),T1 AND T2 ARE IN THE FORMAT
                              YYMMDDHHMM AND T3 IS IN MINUTES AND
                              NO LEAP YEAR.
                      = 3 ==> IBUF(2),T1 AND T2 ARE IN THE FORMAT
                              YYYYMMDDHH AND T3 IS IN HOURS. BUT NOW,
                              LEAP YEARS ARE ACCOUNTED FOR.
      KHEM   (nhem)   = 0,1,2 TYPE DE GRILLE (GLOBAL, PS NORD OU SUD)
 
      SCON   (c)      = SOLAR CONSTANT USED (DEF=1367. W/M**2)
      SMOOTH (k)      = 1, ACCUMULATE RESULT EVERY DELT SECONDS, SAVING
                           THE AVERAGE AT THE NEXT SAMPLE TIMES (DEFAULT).
                      = 0, ONLY DO THE CALCULATION AT SAMPLE TIMES.
 
      NOTE: WHEN KHEM.NE.0, AND WHILE READING CCC TYPE FILES, THE FOLLOWING
      4 PARAMETERS ARE ALSO CONSIDERED. NOT SO WHILE READING RPN FILES.
 
      PX     (i)    = POSITION EN X DU POLE P/R AU COIN INFERIEUR GAUCHE
      PY     (j)    = POSITION EN Y DU POLE P/R AU COIN INFERIEUR GAUCHE
      D60           = RESOLUTION DE LA GRILLE A 60 DEGRES
      DGRW          = ANGLE ENTRE LE MERIDIEN 0 ET AXE DES X
 
      KHEM AS WELL AS THESE LAST FOUR PARAMETRES ARE ALWAYS IGNORED
      WHILE READING RPN/CMC FILES.
 
      IF THE -def KEYWORD IS SPECIFIED ON THE COMMAND LINE WHILE WORKING
      WITH RPN/CMC FILES, solflux WILL ALSO TRY TO DETERMINE APPROPRIATE
      VALUES FOR DAY, GMT AND DELT FROM THE CONTENT OF INFILE.
 
 
      READ(5,5010) DAY,GMT,DELT,SMOOTH,INCDAY
     +             DTM,KHEM,PX,PY,D60,DGRW
 5000 FORMAT(10X,2F5.0,F10.0,I2,1X,I2,I2,1X,I2,4F10.1)
 
 
     EXAMPLE OF INPUT CARD...
 
 *SOLFLUX   182   12      1800 0  1 0  1      62.5     174.5   45000.0     343.0
 * PRECEDING DIRECTIVES ARE APPROPRIATE FOR THE RCM
 
 *SOLFLUX   182   12      1800 0  1
 * PRECEDING DIRECTIVES ARE APPROPRIATE FOR THE GCM
 
         0123456789012345678901234567890123456789012345678901234567890
         1         2         3         4         5         6         7
 
 
      EXIT CONDITIONS...
        0 NO PROBLEMS
        1 UNABLE TO READ INFILE
        2 UNABLE TO READ DIRECTIVES
        3 UNSUPPORTED GRID TYPE
 
