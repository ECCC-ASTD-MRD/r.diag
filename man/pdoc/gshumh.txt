 
      CALL SEQUENCE...
        gshumh   GSES GSTEMP GSLNSP GSSHUM GSRHUM GSLNPT \
                  INPUT OUTPUT [ -kind VAL1 [ VAL2 ] -b VAL3 \ 
                                 -c    VAL4 -d VAL5  -i VAL6 -def ] 
 
 
      DESCRIPTION...
       gshumh  - CONVERTS ETA (SIGMA/HYBRID/GAL-CHEN) LEVEL MOISTURE
                 VARIABLE TO SPECIFIC AND RELATIVE HUMIDITY.
 
 
      AUTHOR   - R. LAPRISE, FEB 29/88.
      LAST REVISION: $Header: /home/cvs/RMNLIB/utils/rdiag/lspgm/gshumh.ptn,v 4.14 2014/09/25 20:20:49 dugas Exp $
 
 
      PURPOSE  - CONVERTS ETA (SIGMA/HYBRID) LEVEL GRID FILE OF MODEL
                 MOISTURE VARIABLE TO SPECIFIC AND RELATIVE HUMIDITY.
 
      NOTES:  1) THIS PROGRAM IS UPWARD COMPATIBLE WITH ITS EARLIER
                 VERSION (GSHUM), EXCEPT THAT IT WILL NOW READ PARAMETRES.
              2) WATER AND ICE PHASES ARE CONSIDERED IN THE CONVERSION
                 WHEN THE COMMAND LINE PARAMETER "-def" IS SPECIFIED.
                 OTHERWISE, ONLY WATER PHASE IS CONSIDERED.
              3) CALCULATIONS ARE DONE WITH THE RPN PHYSIC'S SET
                 OF THERMODYNAMIC CONVERSION FUNCTIONS (I.E. FINTERN)
                 RATHER THAN THE FORMULAS USED IN CCRN MODEL SPW6.
 
      INPUT FILES...
       GSES    = MODEL MOISTURE VARIABLE (ES) ON ETA (SIGMA/HYBRID) LEVELS.
       GSTEMP  = TEMPERATURES ON THE SAME (OR MORE) LEVELS.
       GSLNSP  = CORRESPONDING SERIES OF LN(SF PRES). 
 
      (EXCLUSIVELY FOR GAL-CHEN LEVELS, AS IN THE RCM MODEL)
       GSLNPT  = SET OF LN(PRESSURE).
 
       Note that GSLNSP and GSLNPT pressure units for GAL-CHEN are
       Pascals. The other supported coordinates require GSLNSP
       pressure input fields in MBs.
 
      OUTPUT FILES...
       GSSHUM  = OUTPUT FILE FOR THE SPECIFIC HUMIDITY.
       GSRHUM  = OUTPUT FILE FOR THE RELATIVE HUMIDITY.
 
  
      INPUT PARAMETERS...
 
       COORD (kind 1) = 'SIG'/'ETA'/'GALC' FOR SIGMA/ETA/GAL-CHEN COORDINATE
                        AND THREE VARIANTS OF THE GEM VERTICAL COORDINATES,
                        RESPECTIVELY ('GEM2' AND 'GEM3' ARE THE TWO RPN DEFAULTS).
       MOIST (kind 2) = TYPE OF MOISTURE VARIABLE FOUND IN FILE GSES. 
                        THE CURRENTLY SUPPORTED VALUES ARE AS FOLLOWS:
                        1) 'T-TD' : DEW POINT DEPRESSION  2) 'TD'   : DEW POINT
                        3) 'RLNQ' : -(LN(Q)**-1)          4) 'SQRT' : Q**0.5
                        5) 'Q'    : Q                     6) 'LNQ'  : LN(Q)
                        7) 'QHYB' : HYBRID ( = Q                ; Q <= Q0
                                             = Q0/(1-LN(Q/Q0))  ; Q >  Q0 ),
                                    WHERE Q0 IS THE "SHUMREF" REFERENCE VALUE.
       SHUMREF (b) = REFERENCE VALUE FOR THE HYBRID CASE (DEFAULT; 10.E-3 KG/KG)
       PTOIT   (c) = PRESSURE (PA) OF THE RIGID LID OF THE MODEL.
                     AS OF NOW, HAS TO BE GREATER THAN pression_au_toit PA.
       PREF    (d) = REF PRESSURE USED WHEN COORD='GEM2' OR 'GEM3' (DEF 80000 PA).
       R       (i) = EXPONENT USED ONLY WHEN COORD='GEM2' OR 'GEM3' (DEF 1.0)
 
       NOTE THAT PTOIT IS NOT USED FOR GAL-CHEN LEVELS.
 
       READ(5,5000,END=911) COORD,MOIST,PTOIT,SHUMREF,PREF,R
 5000  FORMAT(10X,2(1X,A4),4E10.0)
 
 
      EXAMPLE OF INPUT CARD...
 
 *GSHUMH.   SIG T-TD      0.01
 
         0123456789012345678901234567890123456789012345678901234567890
         1         2         3         4         5         6         7
 
 
      EXIT CONDITIONS...
        0 NO PROBLEMS
 
      FATAL CONDITIONS...
        1 NOT ENOUGH OR TOO MANY LEVELS IN GSTEMP
        2 NOT ENOUGH OR TOO MANY LEVELS IN GSES
        3 GSES AND GSTEMP NOT THE SAME SIZE
        4 UNABLE TO READ GSLNSP
        5 GSLNSP AND GSTEMP NOT THE SAME SIZE
        6 UNABLE TO READ GSLNPT
        7 GSLNPT AND GSTEMP OT THE SAME SIZE
        8 LESS TIMESTEPS IN GSTEMP THAN IN GSLNSP
        9 MORE THAN ONE SIZE IN GSTEMP
       10 LESS TIMESTEPS IN GSLNPT THAN IN GSLNSP
       11 GSLNPT AND GSTEMP NOT THE SAME SIZE
       12 LESS TIMESTEPS IN GSES THAN IN GSLNSP
       13 GSES AND GSTEMP NOT THE SAME SIZE
       14 UNRECOGNIZED MOISTURE VARIABLE TYPE
       15 PROBLEM READING DIRECTIVE CARD
       16 UNSUPPORTED VERTICAL COORDINATE FOUND IN GSTEMP
       17 COORD PARAMETRE AND GSTEMP COORDINATE MISMATCH
       18 PTOIT GREATER THAN TOP MODEL LEVEL (=ETA(TOP)*PREF)
       19 GSES AND GSTEMP LEVELS ARE NOT ORDERED THE SAME
 
      NON-FATAL CONDITIONS...
      101 FILE TYPE NOT PK84 (CCRN-RPN) AND NOT PK92 (CCCma)
 
