 
      CALL SEQUENCE...
      cofagg  SPFILE GGFILE INPUT OUTPUT [ -lon  VAL1  -lat VAL2 
                                           -kuv [VAL3] -npg VAL4
                                           -kind VAL5 ]
 
 
      DESCRIPTION...
      cofagg  - CONVERTS SPECTRAL FILE TO GAUSSIAN GRIDS
 
 
      AUTHOR  - J.D.Henderson, NOV 06/81.
      LAST REVISION: $Header: /home/cvs/RMNLIB/utils/rdiag/lspgm/cofagg.ptn,v 4.12 2014/09/25 20:20:46 dugas Exp $
 
 
      PURPOSE - READS A FILE OF SPECTRAL COEFFICIENTS (SPFILE), CONVERTS
                THEM TO GAUSSIAN GRIDS,  AND WRITES  THEM ON FILE GGFILE
                WITH PACKING DENSITY NPG. NOTE THAT ALL SPECTRAL FIELDS
                IN SPFILE MUST BE THE SAME SIZE.
 
 
      INPUT FILE...
       SPFILE = INPUT FILE OF SPECTRAL COEFFICIENTS
 
      OUTPUT FILE...
       GGFILE = OUTPUT FILE OF GAUSSIAN GRIDS
 
 
      INPUT PARAMETERS...
 
       LON   = NUMBER OF GRID POINTS IN GAUSSIAN LATITUDE CIRCLE
               (MUST BE EVEN, POWERS OF 2,3,5,7 ARE OK)
       LAT   = NUMBER OF GAUSSIAN LATITUDES IN THE OUTPUT ARRAYS
       KUV   = 0 FOR NORMAL ANALYSIS (PRIMARY DEFAULT)
             = 1 TO CONVERT MODEL WINDS TO REAL WINDS (SECONDARY DEFAULT)
       NPG   = GRID PACKING DENSITY (0 DEFAULTS TO CURRENT)
       KIND    DETERMINES THE PROCESSING OPTION IN THE FOLLOWING WAY
             = 0 ==> GLOBAL COEFFICIENTS INPUT, GLOBAL OUTPUT GRIDS
             < 0 ==> ANTI-SYMMETRIC COEFFICIENTS, HEMISPHERIC OUTPUT
             > 0 ==> SYMMETRIC COEFFICIENTS,        "     "      "  
               ABS(KIND) = 1 ==> NH OUTPUT GRIDS
                           2 ==> SH OUTPUT GRIDS
 
       READ( 5,5010 ) ILG,ILAT,KUV,NPKGG,KIND
 5010  FORMAT(10X,5I5)
 
      COMMENTS CONCERNING THE USAGE OF KUV...
 
       THIS PARAMETER IS ONLY RELEVANT FOR VECTOR COMPONENTS AND SHOULD
       NEVER BE USED FOR SCALAR FIELDS. SPECTRAL PROJECTIONS OF VECTOR
       COMPONENTS CAN ONLY BE CARRIED ON SO-CALLED MODEL COMPONENTS,
       WHICH ARE ASSUMED THE BE THE REAL WINDS MULTIPLIED BY
 
                   COS( LAT )/( EARTH RADIUS ).
 
       THE MODEL WINDS ARE THUS CONTINUOUS AT THE POLES AND CAN THEN
       BE CORRECTLY PROJECTED. THE NORMAL MODE OF OPERATION ASSUMES
       THE PRESENCE OF SO-CALLED MODEL WINDS AND DOES NO CONVERSIONS.
 
 
      EXAMPLE OF INPUT CARD...
 
  COFAGG     64   32    0    4    0
 
         0123456789012345678901234567890123456789012345678901234567890
         1         2         3         4         5         6         7
 
 
      EXIT CONDITIONS...
        0 NO PROBLEMS
        1 ILAT NOT EVEN FOR A GLOBAL CALCULATION
        2 PROBLEM WITH INPUT PARAMETRES OR UNKNOW TRUNCATION TYPE
        3 INTERNAL SPECTRAL REPRESENTATION ERROR
        4 ERROR READING SPFILE. CHANGING SIZE
        5 ERROR ABORT READING INPUT
        6 PREMATURE EOF ON SPFILE
        7 REQUESTED OUTPUT GRID IS TOO SMALL
        8 UNABLE TO ALLOCATE WORKING MEMORY
