 
      CALL SEQUENCE...
       dxdp  XIN XOUT [LNSP] OUTPUT \ 
       [-kind VAL0 [VAL1] -l VAL2 [VAL3] -a VAL4 -d VAL5 -i VAL6 -def [VAL7] ]
 
 
      AUTHORS -  - R.Laprise ET J.D.Henderson, MAY 14 1983.
      LAST REVISION: $Header: /home/cvs/RMNLIB/utils/rdiag/lspgm/dxdp.ptn,v 4.24 2015/03/30 22:22:32 dugas Exp $
 
 
      PURPOSE - COMPUTES VERTICAL DERIVATIVE FOR ALL SETS IN A FILE
 
 
      INPUT FILE...
       XIN  = INPUT FILE OF PRESSURE/ETA/GEMx LEVEL SETS (REAL OR COMPLEX)
              (MINIMUM NUMBER OF LEVELS IS 3)
       LNSP = (OPTIONAL) LOG OF SURFACE PRESSURE FIELD USED BY THE TERRAIN
              FOLLOWING COORDINATES TO DETERMINE THE LOCAL PRESSURE.
 
      OUTPUT FILE... 
       XOUT = VERTICAL (PRESSURE OR LOG-PRESSURE) DERIVATIVES
              AT THE SAME LEVELS AS THE DATA IN FILE XIN
 
       NOTE THAT THERE SHOULD BE AT LEAST 3 AND AT MOST 999 LEVELS IN XIN
 
 
      COMMAND-LINE PARAMETERS...
 
       KIND (1)      = 0, (DEFAULT) USES SIMPLE CENTERED DIFFERENCES.
                       1, USE A WEIGHTED ALGORITHM, TAKING INTO ACCOUNT
                          THE POSSIBLY UN-EVEN LEVEL SPACING, SO THAT THE
                          SCHEME BECOMES SECOND-ORDER ACCURATE. SPECIFYNG
                          THE "def" COMMAND-LINE PARAMETER IS EQUIVALENT,
                          BUT THE "kind" KEY HAS PRECEDENCE OVER IT.
                       2, ALLOWS TO DO THE DERIVATIVE USING A WEIGHTED
                       LOG-PRESSURE DISCRETIZATION.
       KIND   (2)    = INPUT VERTICAL COORDINATE: POSSIBLE OPTIONS ARE
                      'PRES'/'ETA' FOR PRESSURE/GCM-ETA AND 'GEM'/'GEM2'/
                      'GEM3'/'GEM4' FOR THE DIFFERENT VERSIONS OF THE GEM
                       MODEL COORDINATE.
       LEVTYP (l 1)  ='FULL' FOR 'ETA' MOMENTUM VARIABLE, AND
                      'HALF' FOR 'ETA' THERMODYNAMIC ONE.
       LAY    (l 2)  = DEFINES THE POSITION OF LAYER INTERFACES IN RELATION
                       TO LAYER CENTRES FOR THE 'ETA' COORDINATE (SEE BASCAL).
       PTOIT (a)     = PRESSURE (PA) AT THE LID OF MODEL. THE DEFAULT VALUE
                       IS 0.01 OTHERWISE. THIS VALUE IS ONLY REQUIRED WITH
                       THE CCCma GCM VERTICAL COORDINATES.
 
       The next two parametres are only used when COORD='GEM2' or 'GEM3'.
 
       PREF  (d)     = REF PRESSURE (DEF 80000 PA).
       R     (i)     = REFERENCE EXPONENT (DEF 1.0)
 
 
      NOTES: 1) The program requires that data types be either of 'GRID',
                'SUBA' or 'ZONL' when operating with any of the terrain
                following vertical coordinates. The other types of data
                are only supported with pressure vertical coordinates.
             2) 'GEM' is the original GEM ETA coordinate, while 'GEM2' is
                the first GEM HYBRID coordinate as implemented by Edouard
                & Gravel in GEM/DM V2.2.0. 'GEM3' is the normalized version
                that was implemented in the V2.3.1 GEM/DM.
             3) The default value of KIND(2) is determined by the file type
                and the program will also try to determine it by the
                (internal) coding used for the coordinate itself.
             4) Specifying "-def AABB" will force the attempt to read
                a text file called aabb.nml, containing a FORTRAN
                namelist AABB_NML, which in turns will hold two arrays,
                A and B such that the local pressure at level K, PL(K),
                can be calculated as "A(K)+B(K)*PS". This then by-passes
                all of the normal COORD-related calculations for PL(K).
 
 
      EXIT CONDITIONS...
        0 NO PROBLEMS
        1 NOT ENOUGH OR TOO MANY LEVELS IN FIRST SET OF XIN
        2 MORE THAN ONE SIZE IN FILE XIN
        3 NOT ENOUGH LEVELS IN LAST SET READ
        4 LEVELS DO NOT VARY MONOTONICALLY
        5 ILLEGAL "KIND" VALUE
        6 LNSP FILE MISSING OR EMPTY
        7 LNSP AND XIN NOT THE SAME SIZE
        8 PROBLEM READING PARAMETRES
        9 UNRECOGNIZED COORDINATE TYPE
       10 UNABLE TO CONTINUE (SEE NOTE 1)
       11 UNSUPPORTED VERTICAL COORDINATE IN XIN
       12 KIND(2) PARAMETRE AND XIN DATA MISMATCH
       13 MORE THAN ONE VERTICAL COORDINATE IN XIN
       14 UNABLE TO READ AABB NAMELIST
       15 WRONG NUMBER OF A,B IN AABB
 
