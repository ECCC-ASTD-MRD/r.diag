 
      CALL SEQUENCE...
       gsathlt  GSTEMP GSPHI GSRGASM GSLNSP GTTEMP
                GTPHI GTPRES GTDPDTH INPUT OUTPUT \ 
             [ -n VAL1 -a VAL2 -b VAL3 -c VAL4 -kind VAL5 -def ]
 
 
      DESCRIPTION...
       gsathlt - INTERPOLATES TEMP, PHI, PRES AND DPRES/DTHETA FROM ETA
                 (SIGMA/HYBRID) OR PRESSURE LEVELS TO THETA LEVELS.
 
 
      AUTHOR  - J. KOSHYK
      LAST REVISION: $Header: /home/cvs/RMNLIB/utils/rdiag/lspgm/gsathlt.ptn,v 4.14 2014/09/25 19:53:18 dugas Exp $
 
 
      PURPOSE - INTERPOLATES TEMP, PHI, PRES AND DPRES/DTHETA FROM ETA
                (SIGMA/HYBRID) OR PRESSURE LEVELS TO THETA LEVELS.
                EXTRAPOLATION UP AND DOWN IS BY LAPSE RATES, AND
                -DT/DZ IS SPECIFIED BY THE USER.
 
 
      INPUT FILES...
       GSTEMP  = SERIES OF GRIDS OF TEMPERATURE ON ETA OR PRESSURE LEVELS.
       GSPHI   = SERIES OF GRIDS OF PHI ON ETA OR PRESSURE LEVELS.
       GSRGASM = SERIES OF GRIDS OF MOIST GAS CONSTANT ON ETA OR PRESSURE
                 LEVELS ( = RGAS * [ 1 + 0.6 "MIXING RATIO" ] ).
       GSLNSP  = SERIES OF GRIDS OF LN(SF PRES) (UNITS OF MB).
 
      OUTPUT FILES...
       GTTEMP  = THETA LEVEL TEMPERATURES.
       GTPHI   = THETA LEVEL GEOPOTENTIALS.
       GTPRES  = THETA LEVEL PRESSURES (UNITS OF MB)
       GTDPDTH = THETA LEVEL DPRES/DTHETA.
 
 
      INPUT PARAMETERS...
 
       NTHL  (n)    = NUMBER OF REQUESTED THETA LEVELS (DEF 5, MAX 999).
                      IF NTHL IS NEGATIVE, EACH -NTHL LEVTH VALUES ARE READ WITH
                      A I10 FORMAT OR AN E10.0 IF ITS VALUE CONTAINS A DECIMAL
                      POINT.
       RLUP  (a)    = LAPSE RATE, -DT/DZ USED TO EXTRAPOLATE UPWARDS (DEG/M).
       RLDN  (b)    = LAPSE RATE USED TO EXTRAPOLATE DOWNWARDS.
       COORD (kind) = 'SIG'/'ETA'/'ET10'/'ET15' FOR INPUT ETA COORDINATES,
                      'PRES' FOR INPUT PRESSURE COORDINATES (DEF 'PRES').
       PTOIT (c)    = PRESSURE (PA) AT THE LID OF MODEL (DEF 0.01)
 
       LEVTH        = THETA LEVELS (K) (MONOTONE DECREASING I.E. TOP OF
                      ATMOSPHERE TO BOTTOM). THE DEFAULTS ARE AS SPECIFIED
                      IN THE EXAMPLE BELOW.
 
       Notes: 1) The first input line is NOT read if any
                 command-line parameters are passed.
              2) Furthermore, the second line will not be read either
                 if the -def defaults processing mode is requested.
 
       READ(5,5010) NTHL,RLUP,RLDN,COORD,PTOIT
       IF (NTHL.GT.0)
       READ( 5,5020 ) (LEVTH(I),I=1,NTHL)
       IF (NTHL.LT.0)
       READ( 5,5030 ) (LEVTH(I),I=1,-NTHL)
 5010  FORMAT(10X,I5,2E10.0,1X,A4,E10.0)
 5020  FORMAT(16E5.0)
 5030  FORMAT(8E10.0)
 
 
      EXAMPLE OF INPUT CARDS...
 
  GSATHLT.    5        0.   6.5E-03 PRES      0.01
 850. 700. 550. 400. 330.
 
         0123456789012345678901234567890123456789012345678901234567890
         1         2         3         4         5         6         7
 
      EXIT CONDITIONS...
        0 NO PROBLEMS
        1 NTHL TOO LARGE
        2 THETA NOT MONOTONIC DECREASING
        3 CANNOT OPEN GSRGASM
        4 CANNOT OPEN GSPHI
        5 CANNOT OPEN GSLNSP
        6 CANNOT OPEN GSTEMP OR BAD NUMBER OF LEVELS
        7 VARIABLES ARE NOT ALL THE SAME SIZES
        8 ERROR READING FIRST TEMPERATURE SET
        9 MORE THAN ONE SIZE IN GSTEMP
       10 GSTEMP DOES NOT HOLD TEMPERATURES
       11 ERROR READING FIRST GEOPOTENTIAL SET
       12 MORE THAN ONE SIZE IN GSPHI
       13 GSPHI DOES NOT HOLD GEOPOTENTIALS
       14 ERROR READING FIRST GSRGASM SET
       15 MORE THAN ONE SIZE IN GSRGASM
       16 GSRGASM DOES NOT HOLD MOIST GAS ZONSTANTS
       17 UNABLE TO READ FIRST FIELD IN GSLNSP
       18 MORE THAN ONE SIZE IN GSLNSP
       19 GSLNSP DOES NOT HOLD LOG OF SURFACE PRESSURES
       20 EROR ABORT READING INPUT CARD 1
       21 ERROR ABORT READING OUTPUT THETA LEVELS
       22 MORE THAN ONE VERT COORDINATE SET IN DATA
       23 GSTEMP VERT COORDINATE NOT MONOTONIC
       24 GSLNSP DOES NOT CONTAIN LN( SURFP ) FOR EARTH
       25 FOUND UNSUPPORTED DATA TYPE
       26 LEVTH DOES NOT CONTAIN THETA DATA
       27 UNSUPPORTED VERTICAL COORDINATE IN GSTEMP
       28 COORD PARAMETRE AND GSTEMP MISMATCH
 
