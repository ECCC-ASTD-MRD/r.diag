 
      CALL SEQUENCE...
       gsaptp  GSTEMP GSPHIS GSLNSP GPPHI GPTEMP \
             [ GSLNPT GSLNPM / GSTOP ] INPUT OUTPUT \
             [ -plv VAL1 -a    VAL2 -b VAL3 -c VAL4 -d VAL5
               -i   VAL6 -kind VAL7 -l VAL8 -def ]
 
 
      DESCRIPTION...
       gsaptp  - CALCULATES T & PHI ON PRESSURE LEVELS FROM TEMPERATURE
                 ON ETA (SIGMA/HYBRID/GAL-CHEN/GEM) LEVELS.
 
 
 
      AUTHOR  - M. Lazare, AUG 25/89.
      LAST REVISION: $Header: /home/cvs/RMNLIB/utils/rdiag/lspgm/gsaptp.ptn,v 4.26 2014/09/25 20:20:49 dugas Exp $
 
 
      INPUT FILES...
       GSTEMP = SETS OF TEMPERATURE ON MODEL LEVELS ('TT' or 'TEMP')
       GSPHIS = MOUNTAINS (SURFACE GEOPOTENTIAL)    ('MT' or 'PHIS')
       GSLNSP = SET OF LN(SURFACE PRESSURE)         ('LP' or 'LNSP')
 
      (THE FOLLOWING TWO FILES ARE ONLY READ FOR
       MODELS WITH GAL-CHEN LEVELS, SUCH AS THE RCM)
       GSLNPT = SET OF LN(PRESSURE) ON THERMO. LEVELS.
       GSLNPM = SET OF LN(PRESSURE) ON MOMENTUM LEVELS,
                WHICH HERE MUST INCLUDE THE SURFACE.
 
      (THE FOLLOWING FILE MAY ONLY BE READ WITH THE 'GEM' LEVELS)
       GSTOP  =  SERIES OF GRIDS OF PRESSURE AT TOP OF MODEL (! OPTIONAL !)
 
      OUTPUT FILES...
       GPPHI  = PRESSURE LEVEL GEOPOTENTIALS.
       GPTEMP = PRESSURE LEVEL TEMPERATURES.
 
 
      INPUT PARAMETERS...
 
       NPL   (plv)  = NUMBER OF PRESSURE LEVELS (DEF 16, MAX 999).
                      IF NPL IS NEGATIVE, EACH -NPL LEVP VALUES ARE
                      READ WITH A I10 FORMAT OR AN E10.0 IF ITS VALUE
                      CONTAINS A DECIMAL POINT.
       RLUP  (a)    = DT/D LN(SIG) FOR TEMP EXTRAP UPWARDS (DEF 0.0).
       GAMMA (b)    = DT/DZ  FOR TEMP EXTRAP DOWNWARD (DEF 6.5E-3 DEG/M).
 
       COORD (kind) = 'SIG'/'ETA'/'GALC'/'GEM'/'GEM2'/'GEM3' FOR THE
                      SIGMA/ETA/GAL-CHEN COORDINATES AND THREE VARIANTS
                      OF THE GEM VERTICAL COORDINATES, RESPECTIVELY
                      ('GEM2' AND 'GEM3' ARE THE TWO RPN DEFAULTS).
       LAY   (l)    = LAYERING SCHEME FOR CALCULATING LAYER INTERFACES (DEF 3).
 
       PTOIT (c)    = PRESSURE (PA) AT THE MODEL LID (DEF 0.01).
       PREF  (d)    = REF PRESSURE WHEN COORD='GEM2' OR 'GEM3' (DEF 80000 PA).
       R     (i)    = REFERENCE EXPONENT WHEN COORD='GEM2' OR 'GEM3' (DEF 1.0)
 
       LP           = PRESSURE LEVELS (MB) (READ FROM STANDARD INPUT). THE
                      DEFAULTS ARE AS SPECIFIED IN THE EXAMPLE BELOW.
 
       Notes: 1) Units for RLUP are that of D(TEMP)/D(LN PRES)
              2) Units for GSLNSP, GSLNPT and GSLNPM should be consistent.
                 The GAL-CHEN routines expect Pascals, while the routines
                 for the other vertical coordinates expect MBs.
              3) When COORD='GEM', RLUP and LAY are ignored 
              4) When COORD='GEM', PTOIT is only used if GSTOP is empty
              5) When COORD='GALC', LAY and PTOIT are not used 
              6) 'GEM' is the original gem coordinate, while GEM2 is the
                 original hybrid coordinate as implemented by Edouard &
                 Gravel in GEM/DM v2.2.0. GEM3 is the normalized version
                 that was implemented in the v2.3.1 GEM/DM.
              7) The default value of COORD is determined by the file type
                 and the program will also try to determine it by the
                 (internal) coding used for the coordinate itself.
              8) The first input line is NOT read if any
                 command-line parameters are passed.
              9) Furthermore, the second line will not be read either
                 if the -def defaults processing mode is requested.
 
       READ(5,5010) NPL,RLUP,GAMMA,COORD,LAY,PTOIT,PREF,R
       IF (NPL.GT.0)
       READ( 5,5020 ) (LEVP(I),I=1,NPL)
       IF (NPL.LT.0)
       READ( 5,5030 ) (LEVP(I),I=1,-NPL)
 5010  FORMAT(10X,I5,2E10.0,1X,A4,I5,3E10.0)
 5020  FORMAT(16I5)
 5030  FORMAT(8E10.0)
 
 
      EXAMPLE OF INPUT CARDS...
 
  GSAPTP.    16        0.    6.5E-3  GEM    3      pression_au_toit
   10   20   30   50   70  100  150  200  250  300  400  500  700  850  925 1000
 
         01234567890123456789012345678901234567890123456789012345678901234567890
         1         2         3         4         5         6         7
 
 
      EXIT CONDITIONS...
        0 NO PROBLEMS
        1 NUMBER OF PRESSURE LEVELS GREATER THAN MAXLEV
        2 PRESSURE OR MODEL VERT COORDINATE NOT MONOTONIC INCREASING
        3 ERROR READING FIRST SET IN GSLNSP
        4 ERROR READING SURFACE GEOPOTENTIAL
        5 ERROR READING FIRST SET IN GSTEMP
        6 GSTEMP,GSPHIS,GSLNSP NOT THE SAME SIZE
        7 FOUND NAME OTHER THAN TEMP IN GSTEMP
        8 MORE THAN ONE SIZE IN GSTEMP
        9 MISSING GSLNSP
       10 MORE THAN ONE SIZE IN GSLNSP
       11 ERROR ABORT READING INPUT CARD 1
       12 ERROR ABORT READING INPUT CARD 2
       13 ERROR READING FIRST SET IN GSLNPT, GSLNPM OR GSTOP
       14 GSTEMP,GSLNPT,GSLNPM NOT THE SAME SIZE
       15 MISSING GSLNPT SET 
       16 MORE THAN ONE SIZE IN GSLNPT
       17 MISSING GSLNPM SET
       18 MORE THAN ONE SIZE IN GSLNPM
       19 MISSING GSTOP FIELD
       20 MORE THAN ONE SIZE IN GSTOP
       21 PTOIT GREATER THAN TOP MODEL LEVEL (=ETA(TOP)*PREF)
       22 UNSUPPORTED VERTICAL COORDINATE IN GSTEMP
       23 COORD PARAMETRE AND GSTEMP DATA MISMATCH
       24 GEM* DATA DOES NOT INCLUDE THE SURFACE
       25 LP DOES NOT CONTAIN PRESSURE DATA
       
